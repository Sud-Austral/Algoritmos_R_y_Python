---
title: "Carga de la evolución del r0 de un conjunto de entidades en un csv"
author: "DataIntelligence"
date: "22-06-2020"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE
)
```
No aparece Chillan ni Chillan viejo!
```{r uno}
library(knitr)
library(kableExtra)
library(janitor)
library(dplyr)
library(readxl)
library(ggplot2)
library(gridExtra)
# la siguiente linea impide el despliegue de advertencias en forma local:
options(warn = -1)

library(tidyverse)
library(gghighlight)
library(magrittr)
library(readr)
library(ape)
library(ggdendro)
library(rmarkdown)
library(ggplot2)
library(gganimate)
theme_set(theme_bw()) 
```

```{r dos}
options("encoding" = "UTF-8")
# covid19 <- read_xlsx("C:/Users/usuario/Desktop/covid9j.xlsx")

R0 <- read.csv("C:/Users/usuario/Documents/GitHub_Personal/Bases_de_Datos_DS/com_chile_R0.csv")

# le asignammos nombres a las columnas:
names = c("index","comuna", "R0", "cod_comuna", "region")
colnames(R0) = names
colnames(R0)

zona_norte <- R0[ which(
    ((R0$comuna == 'Alto Hospicio') |
    (R0$comuna == 'Antofagasta')|
    (R0$comuna == 'Arica')|
    (R0$comuna == 'Calama')|
    (R0$comuna == 'Iquique'))
    & ((R0$index >14))),]
# zona_norte

zona_norte_chico <- R0[ which(
    ((R0$comuna == 'Coquimbo') |
    (R0$comuna == 'Diego de Almagro')|
    (R0$comuna == 'La Serena')|
    (R0$comuna == 'Ovalle')|
    (R0$comuna == 'Vallenar'))
    & ((R0$index >14))),]
# zona_norte_chico

zona_central <- R0[ which(
    ((R0$comuna == 'Quillota') |
    (R0$comuna == 'Rancagua')|
    (R0$comuna == 'San Fernando')|
    (R0$comuna == 'Valparaíso')|
    (R0$comuna == 'Viña del Mar'))
    & ((R0$index >14))),]
# zona_central

zona_centro_sur <- R0[ which(
    ((R0$comuna == 'Curicó') |
    (R0$comuna == 'Linares')|
    (R0$comuna == 'Los Angeles')|
    (R0$comuna == 'Talca')|
    (R0$comuna == 'Talcahuano'))
    & ((R0$index >14))),]
 zona_centro_sur

zona_sur_austral <- R0[ which(
    ((R0$comuna == 'Ancud') |
    (R0$comuna == 'Osorno')|
    (R0$comuna == 'Puerto Montt')|
    (R0$comuna == 'Punta Arenas')|
    (R0$comuna == 'Temuco')|
    (R0$comuna == 'Valdivia'))
    & ((R0$index >14))),]
# zona_sur_austral

zona_prin_ciu_stgo <- R0[ which(
    ((R0$comuna == 'Estación Central') |
    (R0$comuna == 'Las Condes')|
    (R0$comuna == 'Maipú')|
    (R0$comuna == 'Puente Alto')|
    (R0$comuna == 'Santiago'))
    & ((R0$index >14))),]
# zona_prin_ciu_stgo

zona_menores_R0 <- R0[ which(
    ((R0$comuna == 'Cañete') |
    (R0$comuna == 'Combarbalá')|
    (R0$comuna == 'Fresia')|
    (R0$comuna == 'Los Lagos')|
    (R0$comuna == 'San Pablo'))
    & ((R0$index >14))),]
# zona_menores_R0

R0_1 <- ggplot(zona_norte, aes(index, R0)) + geom_line(size = 1.5, aes(color = factor(comuna)))+ scale_color_brewer(palette="Paired")+
theme_minimal()+ theme(legend.position="top") +

    geom_text(x = 18, y = 2.14, label = "2.07", size=7, color="red") +
    geom_text(x = 21, y = 0.015, label = "0.09", size=7, color="red") +
    geom_text(x = 21, y = 0.01, label = "0.09", size=7, color="red") +
    geom_text(x = 23, y = 2.33, label = "2.27", size=7, color="red") +
    geom_text(x = 30, y = 1.85, label = "1.78", size=7, color="red") +
    geom_text(x = 37, y = 2.05, label = "1.99", size=7, color="red") +
    geom_text(x = 43, y = 0.98, label = "1.06", size=7, color="red") +
    geom_text(x = 46, y = 2.58, label = "2.52", size=7, color="red") +
    geom_text(x = 64, y = 1.56, label = "1.63", size=7, color="red") +
    geom_text(x = 66, y = 2.25, label = "2.13", size=7, color="red") +
    geom_text(x = 69, y = 2.18, label = "2.09", size=7, color="red") +
    geom_text(x = 72, y = 1.52, label = "1.58", size=7, color="red") +
    geom_text(x = 80, y = 2.14, label = "2.07", size=7, color="red") +
    geom_text(x = 86, y = 1.48, label = "1.52", size=7, color="red") +
    geom_text(x = 94, y = 2.65, label = "2.59", size=7, color="red") +
    geom_text(x = 108, y = 1.66, label = "1.72", size=7, color="red") +
    geom_text(x = 112, y = 2.07, label = "2.01", size=7, color="red") +
    geom_text(x = 117, y = 1.95, label = "1.89", size=7, color="red") +
    geom_text(x = 114, y = 1.79, label = "1.85", size=7, color="red") +
    geom_text(x = 106, y = 1.47, label = "1.54", size=7, color="red") +

labs(color = "Comunas") + ggtitle("Evolución diaria del Número Básico de Reproducción \n para las 5 Comunas principales de la Zona Norte de Chile") + xlab("DÍA") + ylab("Número Básico de Reproducción") +
    theme(plot.title = element_text(size = 28, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size=22, face="bold"),
    axis.title.y = element_text(size=22, face="bold"),
    legend.text=element_text(size=22)) +
    theme(legend.title = element_text(size=22, face="bold"))+
    theme(text = element_text(size=20),
    axis.text.x = element_text(angle=0, hjust=1))

png(filename = "R0_1.png", width = 1200, height = 1000,
    pointsize = 12)
print(R0_1)
dev.off()

###
# 
R0_2 <- ggplot(zona_norte_chico, aes(index, R0)) + geom_line(size = 1.5, aes(color = factor(comuna)))+ scale_color_brewer(palette="Paired")+
theme_minimal()+ theme(legend.position="top") +

     geom_text(x = 15, y = 1.79, label = "1.73", size=7, color="red") +
    geom_text(x = 15, y = 1.28, label = "1.24", size=7, color="red") +
    geom_text(x = 15, y = 0.57, label = "0.61", size=7, color="red") +
        geom_text(x = 49, y = 1.7, label = "1.65", size=7, color="red") +
        geom_text(x = 51, y = 1.15, label = "1.18", size=7, color="red") +
        geom_text(x = 56, y = 2.1, label = "2.07", size=7, color="red") +
        geom_text(x = 59, y = 0.73, label = "0.76", size=7, color="red") +
        geom_text(x = 72, y = 2.65, label = "2.61", size=7, color="red") +
        geom_text(x = 78, y = 1.98, label = "1.94", size=7, color="red") +
        geom_text(x = 86, y = 1.94, label = "1.9", size=7, color="red") +
        geom_text(x = 102, y = 0.95, label = "0.98", size=7, color="red") +
        geom_text(x = 78, y = 1.33, label = "1.29", size=7, color="red") +
        geom_text(x = 101, y = 1.47, label = "1.43", size=7, color="red") +
        geom_text(x = 112, y = 1.51, label = "1.47", size=7, color="red") +
        geom_text(x = 107, y = 1.47, label = "1.43", size=7, color="red") +

labs(color = "Comunas") + ggtitle("Evolución diaria del Número Básico de Reproducción \n para las 5 Comunas principales de la Zona Norte Chico de Chile") + xlab("DÍA") + ylab("Número Básico de Reproducción") +
    theme(plot.title = element_text(size = 28, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size=22, face="bold"),
    axis.title.y = element_text(size=22, face="bold"),
    legend.text=element_text(size=22)) +
    theme(legend.title = element_text(size=22, face="bold"))+
    theme(text = element_text(size=20),
    axis.text.x = element_text(angle=0, hjust=1))

png(filename = "R0_2.png", width = 1200, height = 1000,
    pointsize = 12)
print(R0_2)
dev.off()

###

R0_3 <- ggplot(zona_central, aes(index, R0)) + geom_line(size = 1.5, aes(color = factor(comuna)))+ scale_color_brewer(palette="Paired")+
theme_minimal()+ theme(legend.position="top") +

    geom_text(x = 18, y = 1.59, label = "1.54", size=7, color="red") +
        geom_text(x = 15, y = 1, label = "0.96", size=7, color="red") +
        geom_text(x = 15, y = 0.8, label = "0.75", size=7, color="red") +
        geom_text(x = 20, y = 0.62, label = "0.65", size=7, color="red") +
        geom_text(x = 45, y = 0.65, label = "0.69", size=7, color="red") +
        geom_text(x = 57, y = 2.59, label = "2.55", size=7, color="red") +
        geom_text(x = 60, y = 2.54, label = "2.5", size=7, color="red") +
        geom_text(x = 64, y = 2.15, label = "2.1", size=7, color="red") +
        geom_text(x = 79, y = 2.29, label = "2.24", size=7, color="red") +
        geom_text(x = 88, y = 2.46, label = "2.41", size=7, color="red") +
        geom_text(x = 93, y = 2.89, label = "2.84", size=7, color="red") +
        geom_text(x = 111, y = 1.9, label = "1.83", size=7, color="red") +      geom_text(x = 115, y = 1.86, label = "1.81", size=7, color="red") +
        geom_text(x = 113, y = 1.71, label = "1.76", size=7, color="red") +
        geom_text(x = 110, y = 1.55, label = "1.6", size=7, color="red") +
            geom_text(x = 53, y = 0.81, label = "0.84", size=7, color="red") +
            geom_text(x = 71, y = 0.95, label = "0.99", size=7, color="red") +
            geom_text(x = 76, y = 1.15, label = "1.2", size=7, color="red") +
            geom_text(x = 84, y = 1.3, label = "1.33", size=7, color="red") +



labs(color = "Comunas") + ggtitle("Evolución diaria del Número Básico de Reproducción \n para las 5 Comunas principales de la Zona Central de Chile") + xlab("DÍA") + ylab("Número Básico de Reproducción") +
    theme(plot.title = element_text(size = 28, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size=22, face="bold"),
    axis.title.y = element_text(size=22, face="bold"),
    legend.text=element_text(size=22)) +
    theme(legend.title = element_text(size=22, face="bold"))+
    theme(text = element_text(size=20),
    axis.text.x = element_text(angle=0, hjust=1))

png(filename = "R0_3.png", width = 1200, height = 1000,
    pointsize = 12)
print(R0_3)
dev.off()

###

# 
R0_4 <- ggplot(zona_centro_sur, aes(index, R0)) + geom_line(size = 1.5, aes(color = factor(comuna)))+ scale_color_brewer(palette="Paired")+
theme_minimal()+ theme(legend.position="top") +

    geom_text(x = 18, y = 1.29, label = "1.24", size=7, color="red") +
        geom_text(x = 21, y = 2.83, label = "2.78", size=7, color="red") +
        geom_text(x = 24, y = 0.4, label = "0.45", size=7, color="red") +
        geom_text(x = 30, y = 1.49, label = "1.44", size=7, color="red") +
        geom_text(x = 29, y = 0.58, label = "0.63", size=7, color="red") +
        geom_text(x = 40, y = 1.38, label = "1.33", size=7, color="red") +
        geom_text(x = 48, y = 0.49, label = "0.54", size=7, color="red") +
        geom_text(x = 71, y = 0.78, label = "0.94", size=7, color="red") +
        geom_text(x = 77, y = 2.43, label = "2.38", size=7, color="red") +
        geom_text(x = 83, y = 0.9, label = "0.99", size=7, color="red") +
        geom_text(x = 89, y = 2.12, label = "2.07", size=7, color="red") +
        geom_text(x = 103, y = 1.95, label = "1.9", size=7, color="red") +
        geom_text(x = 128, y = 1.75, label = "1.7", size=7, color="red") +
        geom_text(x = 120, y = 1.77, label = "1.72", size=7, color="red") +
        geom_text(x = 109, y = 1.75, label = "1.69", size=7, color="red") +
        geom_text(x = 115, y = 1.37, label = "1.42", size=7, color="red") +
        geom_text(x = 122, y = 1.57, label = "1.62", size=7, color="red") +


labs(color = "Comunas") + ggtitle("Evolución diaria del Número Básico de Reproducción \n para las 5 Comunas principales de la Zona Centro Sur de Chile") + xlab("DÍA") + ylab("Número Básico de Reproducción") +
    theme(plot.title = element_text(size = 28, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size=22, face="bold"),
    axis.title.y = element_text(size=22, face="bold"),
    legend.text=element_text(size=22)) +
    theme(legend.title = element_text(size=22, face="bold"))+
    theme(text = element_text(size=20),
    axis.text.x = element_text(angle=0, hjust=1))

png(filename = "R0_4.png", width = 1200, height = 1000,
    pointsize = 12)
print(R0_4)
dev.off()

###

R0_5 <- ggplot(zona_sur_austral, aes(index, R0)) + geom_line(size = 1.5, aes(color = factor(comuna)))+ scale_color_brewer(palette="Paired")+
theme_minimal()+ theme(legend.position="top") +

    geom_text(x = 15, y = 3.85, label = "3.79", size=7, color="red") +
    geom_text(x = 15, y = 0.14, label = "0.21", size=7, color="red") +
        geom_text(x = 20, y = 3.17, label = "3.03", size=7, color="red") +
        geom_text(x =26, y = 0.54, label = "0.61", size=7, color="red") +
        geom_text(x = 42, y = 0.74, label = "0.81", size=7, color="red") +
        geom_text(x = 50, y = 1.93, label = "1.86", size=7, color="red") +
        geom_text(x = 63, y = 1, label = "1.07", size=7, color="red") +
        geom_text(x = 77, y = 0.99, label = "1.06", size=7, color="red") +
        geom_text(x = 88, y = 1.73, label = "1.65", size=7, color="red") +
        geom_text(x = 115, y = 1.53, label = "1.58", size=7, color="red") +
        geom_text(x = 124, y = 1.85, label = "1.78", size=7, color="red") +
        geom_text(x = 106, y = 1, label = "1.06", size=7, color="red") +
        geom_text(x = 116, y = 1.29, label = "1.27", size=7, color="red") +
        geom_text(x = 116, y = 1.41, label = "1.41", size=7, color="red") +
        geom_text(x = 115, y = 1.15, label = "1.21", size=7, color="red") +



labs(color = "Comunas") + ggtitle("Evolución diaria del Número Básico de Reproducción \n para las 5 Comunas principales de la Zona Sur Austral de Chile") + xlab("DÍA") + ylab("Número Básico de Reproducción") +
    theme(plot.title = element_text(size = 28, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size=22, face="bold"),
    axis.title.y = element_text(size=22, face="bold"),
    legend.text=element_text(size=22)) +
    theme(legend.title = element_text(size=22, face="bold"))+
    theme(text = element_text(size=20),
    axis.text.x = element_text(angle=0, hjust=1))

png(filename = "R0_5.png", width = 1200, height = 1000,
    pointsize = 12)
print(R0_5)
dev.off()

###

R0_6 <- ggplot(zona_prin_ciu_stgo, aes(index, R0)) + geom_line(size = 1.5, aes(color = factor(comuna)))+ scale_color_brewer(palette="Paired")+
theme_minimal()+ theme(legend.position="top") +

    geom_text(x = 16, y = 3.87, label = "3.73", size=7, color="red") +
    geom_text(x = 26, y = 2.47, label = "2.37", size=7, color="red") +

      geom_text(x = 37, y = 1.73, label = "1.65", size=7, color="red") +
      geom_text(x = 56, y = 2.1, label = "2.02", size=7, color="red") +
      geom_text(x = 63, y = 2.42, label = "2.32", size=7, color="red") +




      geom_text(x = 19, y = -1.17, label = "-1.1", size=7, color="red") +
        geom_text(x = 24, y = -0.56, label = "-0.48", size=7, color="red") +
        geom_text(x = 59, y = 0.86, label = "0.95", size=7, color="red") +
        geom_text(x = 91, y = 1.15, label = "1.24", size=7, color="red") +
        geom_text(x = 83, y = 2.5, label = "2.41", size=7, color="red") +
        geom_text(x = 87, y = 2.47, label = "2.37", size=7, color="red") +
        geom_text(x = 94, y = 2.05, label = "1.94", size=7, color="red") +
        geom_text(x = 99, y = 1.88, label = "1.78", size=7, color="red") +
        geom_text(x = 121, y = 1.25, label = "1.25", size=7, color="red") +
        geom_text(x = 123, y = 1.49, label = "1.39", size=7, color="red") +
        geom_text(x = 113, y = 1.17, label = "1.26", size=7, color="red") +






labs(color = "Comunas") + ggtitle("Evolución diaria del Número Básico de Reproducción \n para las 5 Comunas principales de la Región Metropolitana de Chile") + xlab("DÍA") + ylab("Número Básico de Reproducción") +
    theme(plot.title = element_text(size = 28, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size=22, face="bold"),
    axis.title.y = element_text(size=22, face="bold"),
    legend.text=element_text(size=22)) +
    theme(legend.title = element_text(size=22, face="bold"))+
    theme(text = element_text(size=20),
    axis.text.x = element_text(angle=0, hjust=1))

png(filename = "R0_6.png", width = 1200, height = 1000,
    pointsize = 12)
print(R0_6)
dev.off()

###

R0_7 <- ggplot(zona_menores_R0, aes(index, R0)) + geom_line(size = 1.5, aes(color = factor(comuna)))+ scale_color_brewer(palette="Paired")+
theme_minimal()+ theme(legend.position="top") +

    geom_text(x = 15, y = 0.832, label = "0.82", size=7, color="red") +  
    geom_text(x = 17, y = 0.636, label = "0.64", size=7, color="red") + 
      geom_text(x = 13, y = 0.683, label = "0.68", size=7, color="red") + 
      geom_text(x = 26, y = 0.5, label = "0.54", size=7, color="red") + 
      geom_text(x = 29, y = 0.833, label = "0.83", size=7, color="red") + 
      geom_text(x = 41, y = 0.848, label = "0.84", size=7, color="red") + 
      geom_text(x = 47, y = 0.92, label = "0.91", size=7, color="red") + 
        geom_text(x = 26, y = 0.528, label = "0.54", size=7, color="red") + 
  
          geom_text(x = 26, y = 0.965, label = "0.96", size=7, color="red") + 
          geom_text(x = 475, y = 0.85, label = "0.85", size=7, color="red") + 
          geom_text(x = 61, y = 0.882, label = "0.87", size=7, color="red") + 
          geom_text(x = 108, y = 0.898, label = "0.89", size=7, color="red") + 

    
labs(color = "Comunas") + ggtitle("Evolución diaria del Número Básico de Reproducción \n para las 5 Comunas con valores de R0 más reducidos") + xlab("DÍA") + ylab("Número Básico de Reproducción") + 
    theme(plot.title = element_text(size = 28, face = "bold", hjust = 0.5),
    axis.title.x = element_text(size=22, face="bold"),
    axis.title.y = element_text(size=22, face="bold"),
    legend.text=element_text(size=22)) + 
    theme(legend.title = element_text(size=22, face="bold"))+
    theme(text = element_text(size=20),
    axis.text.x = element_text(angle=0, hjust=1)) 

png(filename = "R0_7.png", width = 1200, height = 1000,
    pointsize = 12)
print(R0_7)
dev.off()

```

